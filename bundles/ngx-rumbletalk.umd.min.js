!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs/operators"),require("@angular/core"),require("@angular/common/http"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("ngx-rumbletalk",["exports","rxjs/operators","@angular/core","@angular/common/http","@angular/platform-browser"],e):e(t["ngx-rumbletalk"]={},t.rxjs.operators,t.ng.core,t.ng.common.http,t.ng.platformBrowser)}(this,function(t,e,n,i,r){"use strict";var o=(a.prototype.address=function(t){return this.http.get("https://www.rumbletalk.com/client/service.php?hash="+t).pipe(e.map(function(t){return t.address}))},a.prototype.reload=function(t){return this.http.get(t)},a.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],a.ctorParameters=function(){return[{type:i.HttpClient}]},a.ngInjectableDef=n.defineInjectable({factory:function(){return new a(n.inject(i.HttpClient))},token:a,providedIn:"root"}),a);function a(t){this.http=t}var l,s,h,c="https://",p="https://www.rumbletalk.com/",m=(d.prototype.ngOnInit=function(){var e=this,t=navigator.userAgent.toUpperCase();this.mobile=-1!==t.indexOf("MOBILE")||-1!==t.indexOf("ANDROID")||-1!==t.indexOf("IOS"),this.mobile||this.embedType!==this.EMBED_TYPES.MOBILE_FULL||(this.embedType=this.EMBED_TYPES.EMBEDDED),this.service.address(this.hash).subscribe(function(t){l=t,e.mobile||(e.iframeElement.nativeElement.src="https://"+t+"/"+e.hash+"/"),e.addListeners(),e.instantiateQuery()})},d.prototype.ngOnDestroy=function(){clearInterval(s)},d.prototype.addListeners=function(){window.addEventListener("message",this.info.bind(this),!1)},d.prototype.info=function(t){isFinite(t.data)?clearInterval(s):"object"==typeof t.data&&t.data.reload&&this.reload()},d.prototype.reload=function(){var n=this,t=p+"client/service.php?hash="+this.hash;this.service.reload(t).subscribe(function(t){if(t.status){l=t.address;var e=c+l+"/"+n.hash+"/";n.iframeElement.nativeElement instanceof HTMLIFrameElement?n.iframeElement.nativeElement.src=e:n.iframeElement.nativeElement.location.href=e,n.instantiateQuery()}},function(t){return location.reload()})},d.prototype.instantiateQuery=function(){s=setInterval(this.query.bind(this),1e3)},d.prototype.query=function(){try{var t,e=void 0;t=this.iframeElement.nativeElement instanceof HTMLIFrameElement?(e=this.iframeElement.nativeElement.contentWindow,c+l):(e=this.iframeElement.nativeElement,p),e.postMessage("toolbar",t)}catch(n){}},d.prototype.validateOrigin=function(t){return/^https:\/\/.+\.rumbletalk\.(net|com)(:4433)?$/.test(t)},d.prototype.handleImageLoad=function(t){var e=t.target,n=t.currentTarget.parentNode;n.style.height=e.height+"px",n.style.width=e.width+"px",this.mobile||(this.chatDivElement.nativeElement.style.bottom=e.height+"px")},d.prototype.toggleFloatingChatStart=function(t){var e=this;void 0===t&&(t=!1),clearInterval(h);var n=-100;"hidden"!==this.chatDivElement.nativeElement.style.visibility||t||(n*=-1,this.chatDivElement.nativeElement.style.width=0,this.chatDivElement.nativeElement.style.height=0,this.chatDivElement.nativeElement.style.overflow="visible",this.chatDivElement.nativeElement.style.visibility="visible"),h=setInterval(function(){e.toggleFloatingChat(n)},1)},d.prototype.toggleFloatingChat=function(t){var e=this.chatDivElement.nativeElement,n=e.offsetWidth+t,i=e.offsetHeight+t,r=0;n<0&&(n=0),i<0&&(i=0),0<=n&&0<=i&&(n<=this.width?r=1:n=this.width,i<=this.height?r=1:i=this.height,e.style.width=n+"px",e.style.height=i+"px"),(!r||n<=0||i<=0)&&(clearInterval(h),n<this.width&&(e.style.visibility="hidden",e.style.overflow="hidden"))},d.prototype.openChat=function(){var t,e=p+"client/chat.php?"+this.hash,n=this.iframeElement;if(n)n.nativeElement.focus();else{var i=window.open(e);t=setInterval(function(){i.closed&&clearInterval(t)},100)}},d.decorators=[{type:n.Component,args:[{selector:"ngx-rumbletalk",template:'<div\r\n  class="rumbletalk-embed"\r\n  [ngStyle]="{ height: height ? height + \'px\' : \'100%\' }"\r\n  *ngIf="embedType === EMBED_TYPES.EMBEDDED"\r\n>\r\n  <iframe\r\n    #iframe\r\n    frameBorder="0"\r\n    allow="microphone; camera"\r\n    allowtransparency="true"\r\n    [ngStyle]="{ width: width ? width + \'px\' : \'100%\' }"\r\n  ></iframe>\r\n</div>\r\n\r\n<div\r\n  class="rumbletalk-floating"\r\n  [ngClass]="{ \'rumbletalk-floating-right\': side === 0, \'rumbletalk-floating-left\': side !== 0 }"\r\n  (click)="mobile ? openChat() : toggleFloatingChatStart()"\r\n  *ngIf="embedType === EMBED_TYPES.FLOATING"\r\n>\r\n  <img\r\n    alt="Click to join the conversation"\r\n    title="Click to join the conversation"\r\n    [src]="image"\r\n    [ngClass]="{ right: side === 0, left: side !== 0 }"\r\n    (load)="handleImageLoad($event)"\r\n  />\r\n\r\n  <div\r\n    class="counter-div"\r\n    [ngStyle]="{ top: counterTop + \'px\', left: counterLeft + \'px\' }"\r\n    *ngIf="showDetails"\r\n  >\r\n    <img alt="loading" [src]="cdn + \'images/toolbar/mini_wait.gif\'" *ngIf="!mobile" />\r\n  </div>\r\n\r\n  <div\r\n    #chatDiv\r\n    class="chat-div"\r\n    [ngClass]="{ \'chat-div-left\': side !== 0, \'chat-div-right\': side === 0 }"\r\n    style="visibility: hidden"\r\n    *ngIf="!mobile"\r\n  >\r\n    <img\r\n      class="close-button"\r\n      alt="close"\r\n      [src]="cdn + \'images/c.png\'"\r\n      [ngStyle]="side === 0 ? { left: \'-8px\' } : { right: \'-8px\' }"\r\n      (click)="toggleFloatingChatStart(true)"\r\n    />\r\n\r\n    <iframe\r\n      #iframe\r\n      frameBorder="0"\r\n      allow="microphone; camera"\r\n      allowtransparency="true"\r\n      [ngStyle]="{ width: width ? width + \'px\' : \'100%\' }"\r\n    ></iframe>\r\n  </div>\r\n</div>\r\n\r\n<div\r\n  class="rumbletalk-embed-image"\r\n  (click)="openChat()"\r\n  *ngIf="embedType === EMBED_TYPES.MOBILE_FULL"\r\n>\r\n  <img\r\n    alt="Click here to join the chat"\r\n    title="Click here to join the chat"\r\n    role="link"\r\n    [src]="cdn + \'images/mobile-redirect.png\'"\r\n  />\r\n\r\n  <h3 role="link">Click here to join the chat</h3>\r\n</div>\r\n',changeDetection:n.ChangeDetectionStrategy.OnPush,styles:[".rumbletalk-embed{overflow:hidden}iframe{height:100%;overflow:hidden;background-color:transparent}.rumbletalk-floating{position:fixed;bottom:5px;z-index:2147483647;cursor:pointer}.rumbletalk-floating-left{left:5px}.rumbletalk-floating-right{right:5px}.rumbletalk-floating>img{max-width:none;position:absolute;bottom:0}.rumbletalk-floating>img.left{left:0}.rumbletalk-floating>img.right{right:0}.counter-div{position:absolute;width:28px;text-align:center;font:bold 12px arial;color:#000;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.chat-div{position:absolute;bottom:75px;overflow:hidden;padding:0;height:0}.chat-div-left{left:0}.chat-div-right{right:0}.close-button{cursor:pointer;position:absolute;top:-9px}.rumbletalk-embed-image{text-align:center}.rumbletalk-embed-image img{cursor:pointer}"]}]}],d.ctorParameters=function(){return[{type:o}]},d.propDecorators={iframeElement:[{type:n.ViewChild,args:["iframe"]}],chatDivElement:[{type:n.ViewChild,args:["chatDiv"]}],hash:[{type:n.Input}],side:[{type:n.Input}],embedType:[{type:n.Input}],cdn:[{type:n.Input}],floating:[{type:n.Input}],width:[{type:n.Input}],height:[{type:n.Input}],bounce:[{type:n.Input}],image:[{type:n.Input}],showDetails:[{type:n.Input}]},d);function d(t){this.service=t,this.EMBED_TYPES={EMBEDDED:0,FLOATING:1,MOBILE_FULL:2},this.counterTop=14,this.counterLeft=23}var g=(u.decorators=[{type:n.NgModule,args:[{declarations:[m],imports:[i.HttpClientModule,r.BrowserModule],exports:[m]}]}],u);function u(){}t.NgxRumbletalkService=o,t.NgxRumbletalkComponent=m,t.NgxRumbletalkModule=g,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-rumbletalk.umd.min.js.map