!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs/operators"),require("@angular/core"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("ngx-rumbletalk",["exports","rxjs/operators","@angular/core","@angular/common/http"],t):t(e["ngx-rumbletalk"]={},e.rxjs.operators,e.ng.core,e.ng.common.http)}(this,function(e,t,n,r){"use strict";var a=(o.prototype.address=function(e){return this.http.get("https://www.rumbletalk.com/client/service.php?hash="+e).pipe(t.map(function(e){return e.address}))},o.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],o.ctorParameters=function(){return[{type:r.HttpClient}]},o.ngInjectableDef=n.defineInjectable({factory:function(){return new o(n.inject(r.HttpClient))},token:o,providedIn:"root"}),o);function o(e){this.http=e}var i,s,p="https://",l="https://www.rumbletalk.com/",c=(h.prototype.ngOnInit=function(){var t=this;this.service.address(this.hash).subscribe(function(e){i=e,t.iframeElement.nativeElement.src="https://"+e+"/"+t.hash+"/",t.addListeners(),t.instantiateQuery()})},h.prototype.addListeners=function(){window.addEventListener("message",this.info.bind(this),!1)},h.prototype.info=function(e){isFinite(e.data)?clearInterval(s):"object"==typeof e.data&&e.data.reload&&this.reload()},h.prototype.reload=function(){var r=this,a=new XMLHttpRequest;a.open("GET",l+"client/service.php?hash="+this.hash,!0),a.onreadystatechange=function(){if(4===a.readyState)try{var e=JSON.parse(a.responseText);if(e.status){i=e.address;var t=p+i+"/"+r.hash+"/";r.iframeElement.nativeElement instanceof HTMLIFrameElement?r.iframeElement.nativeElement.src=t:r.iframeElement.nativeElement.location.href=t,r.instantiateQuery()}}catch(n){location.reload()}},a.send()},h.prototype.instantiateQuery=function(){s=setInterval(this.query.bind(this),1e3)},h.prototype.query=function(){try{var e,t=void 0;e=this.iframeElement.nativeElement instanceof HTMLIFrameElement?(t=this.iframeElement.nativeElement.contentWindow,p+i):(t=this.iframeElement.nativeElement,l),t.postMessage("toolbar",e)}catch(n){}},h.prototype.validateOrigin=function(e){return/^https:\/\/.+\.rumbletalk\.(net|com)(:4433)?$/.test(e)},h.decorators=[{type:n.Component,args:[{selector:"ngx-rumbletalk",template:'<iframe\r\n  #iframe\r\n  allowtransparency="true"\r\n  allow="microphone; camera"\r\n  [width]="width"\r\n  [height]="height"\r\n></iframe>\r\n',changeDetection:n.ChangeDetectionStrategy.OnPush,styles:["iframe{border:0;width:100%;height:100%;background-color:transparent;overflow:hidden}"]}]}],h.ctorParameters=function(){return[{type:a}]},h.propDecorators={iframeElement:[{type:n.ViewChild,args:["iframe"]}],floating:[{type:n.Input}],width:[{type:n.Input}],height:[{type:n.Input}],hash:[{type:n.Input}]},h);function h(e){this.service=e}var u=(m.decorators=[{type:n.NgModule,args:[{declarations:[c],imports:[r.HttpClientModule],exports:[c]}]}],m);function m(){}e.NgxRumbletalkService=a,e.NgxRumbletalkComponent=c,e.NgxRumbletalkModule=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-rumbletalk.umd.min.js.map